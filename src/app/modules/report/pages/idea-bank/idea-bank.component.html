<div ngClass.gt-sm="content-index" ngClass.lt-md="content-index">

  <header fxLayout="column" class="active-elevation">

    <div fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="start center">

      <mat-icon fontIcon="tips_and_updates"></mat-icon>
      <p class="mat-headline-6">Reporte de ejemplo para el banco de ideas</p>

      <span fxFlex></span>

      <button mat-stroked-button (click)="downloadXlsx()" color="primary">
        <mat-icon fontIcon="file_download"></mat-icon>
        Exportar .xlsx
      </button>

    </div>

    <div fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="start center">
      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Año Ingreso</mat-label>
        <input matInput type="text" [(ngModel)]="yearCreated">
        <button *ngIf="yearCreated" matSuffix mat-icon-button aria-label="Clear" (click)="yearCreated=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>


      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Institucion</mat-label>
        <mat-select [(value)]="idEntity" (selectionChange)="filterProduct(idEntity)">
          <mat-option *ngFor="let obj of institutions" [value]="obj.idEntidad">{{obj.nombre}}</mat-option>
        </mat-select>
        <button *ngIf="idEntity" matSuffix mat-icon-button aria-label="Clear"
          (click)="idEntity=''; productName = ''; productIsDisabled = true">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>


      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Estado de la Idea</mat-label>
        <mat-select [(value)]="state">
          <mat-option value="TODAS">Todas</mat-option>
          <mat-option value="CREADA">Creadas</mat-option>
          <mat-option value="ENVIADA">Enviadas</mat-option>
          <mat-option value="CALIFICADA">Calificadas</mat-option>
        </mat-select>
        <button *ngIf="state" matSuffix mat-icon-button aria-label="Clear" (click)="state=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Numero de Idea</mat-label>
        <input matInput type="text" [(ngModel)]="registerCode">
        <button *ngIf="registerCode" matSuffix mat-icon-button aria-label="Clear" (click)="registerCode=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>


      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Selección del Producto</mat-label>
        <mat-select [(value)]="productName" [disabled]="productIsDisabled">
          <mat-option *ngFor="let product of products" [value]="product.nombre">
            {{ product.nombre }}
          </mat-option>
        </mat-select>
        <button *ngIf="productName" matSuffix mat-icon-button aria-label="Clear" (click)="productName=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>


    </div>

    <!-- Second Row -->

    <!-- <div fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="start center">
      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Tipo de idea de proyecto</mat-label>
        <mat-select [(value)]="typeIdea" (selectionChange)="enableTypeProject()">
          <mat-option value="Forma Capital Fijo">
            Forma Capital Fijo
          </mat-option>
          <mat-option value="No Forma Capital Fijo">
            No Forma Capital Fijo
          </mat-option>
        </mat-select>
        <button *ngIf="typeIdea" matSuffix mat-icon-button aria-label="Clear" (click)="typeIdea=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Proceso</mat-label>
        <mat-select [(value)]="proccess">
          <mat-option *ngFor="let proc of dataSourceProcesos" [value]="proc.DESCRIPCION">
            {{proc.DESCRIPCION}}
          </mat-option>
        </mat-select>
        <button *ngIf="proccess" matSuffix mat-icon-button aria-label="Clear" (click)="proccess=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Objeto</mat-label>
        <mat-select [(value)]="state">
          <mat-option *ngFor="let obj of objetos" [value]="obj.NOMBRE">{{obj.NOMBRE}}</mat-option>
        </mat-select>
        <button *ngIf="state" matSuffix mat-icon-button aria-label="Clear" (click)="state=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Departamento</mat-label>
        <input matInput type="text" [(ngModel)]="registerCode">
        <button *ngIf="registerCode" matSuffix mat-icon-button aria-label="Clear" (click)="registerCode=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Municipio</mat-label>
        <input matInput type="text" [(ngModel)]="registerCode">
        <button *ngIf="registerCode" matSuffix mat-icon-button aria-label="Clear" (click)="registerCode=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

    </div> -->

    <!-- Third Row -->


    <!-- <div fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="start center">
      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Tipo proyecto</mat-label>
        <mat-select [(value)]="typeIdea" (selectionChange)="enableTypeProject()">
          <mat-option value="Forma Capital Fijo">
            Forma Capital Fijo
          </mat-option>
          <mat-option value="No Forma Capital Fijo">
            No Forma Capital Fijo
          </mat-option>
        </mat-select>
        <button *ngIf="yearCreated" matSuffix mat-icon-button aria-label="Clear" (click)="yearCreated=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Avance</mat-label>
        <input matInput type="text" [(ngModel)]="yearCreated">
        <button *ngIf="yearCreated" matSuffix mat-icon-button aria-label="Clear" (click)="yearCreated=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Complejidad</mat-label>
        <mat-select [(value)]="state">
          <mat-option value="TODAS">Todas</mat-option>
          <mat-option value="CREADA">Creadas</mat-option>
          <mat-option value="ENVIADA">Enviadas</mat-option>
          <mat-option value="CALIFICADA">Calificadas</mat-option>
        </mat-select>
        <button *ngIf="state" matSuffix mat-icon-button aria-label="Clear" (click)="state=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Costo de la Preinversion</mat-label>
        <input matInput type="text" [(ngModel)]="registerCode">
        <button *ngIf="registerCode" matSuffix mat-icon-button aria-label="Clear" (click)="registerCode=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Costo de la Inversion</mat-label>
        <input matInput type="text" [(ngModel)]="registerCode">
        <button *ngIf="registerCode" matSuffix mat-icon-button aria-label="Clear" (click)="registerCode=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

    </div> -->

    <div fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="start center">

      <mat-form-field appearance="outline" floatLabel="always" class="small-input no-hint">
        <mat-label>Posibles Fuentes de Financiamiento</mat-label>
        <input matInput type="text" [(ngModel)]="foundingSourcesName" disabled>
        <button *ngIf="foundingSourcesName" matSuffix mat-icon-button aria-label="Clear"
          (click)="foundingSourcesName=''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>


      <button mat-mini-fab (click)="sendFilter()" color="accent" class="menu-button-add">
        <mat-icon>search</mat-icon>
      </button>
    </div>

  </header>

  <ngx-simplebar class="table active-elevation">

    <app-not-found *ngIf="dataSource.data.length === 0"
      text="Ingrese algún filtro para generar el reporte..."></app-not-found>

    <table mat-table *ngIf="dataSource.data.length > 0" [dataSource]="dataSource" multiTemplateDataRows>

      <ng-container matColumnDef="Idea">
        <th mat-header-cell *matHeaderCellDef> Idea </th>
        <td mat-cell *matCellDef="let element"> {{element.registerCode}} </td>
      </ng-container>

      <ng-container matColumnDef="Producto">
        <th mat-header-cell *matHeaderCellDef> Producto </th>
        <td mat-cell *matCellDef="let element"> {{element.productName}} </td>
      </ng-container>

      <ng-container matColumnDef="Institucion">
        <th mat-header-cell *matHeaderCellDef> Institución </th>
        <td mat-cell *matCellDef="let element"> {{element.nameEntity}} </td>
      </ng-container>

      <ng-container matColumnDef="Problematica">
        <th mat-header-cell *matHeaderCellDef> Problemática </th>
        <td mat-cell *matCellDef="let element"> {{element.baseLine}} </td>
      </ng-container>


      <ng-container matColumnDef="expand">
        <th mat-header-cell *matHeaderCellDef> </th>
        <td mat-cell *matCellDef="let element">
          <button mat-icon-button aria-label="expand row"
            (click)="(expandedElement = expandedElement === element ? null : element); $event.stopPropagation()">
            <mat-icon *ngIf="expandedElement !== element">keyboard_arrow_down</mat-icon>
            <mat-icon *ngIf="expandedElement === element">keyboard_arrow_up</mat-icon>
          </button>
        </td>
      </ng-container>
      <ng-container matColumnDef="expandedDetail">
        <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplayWithExpand.length">
          <div class="example-element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">

            <div *ngFor="let alternative of element?.alternatives; let i = index">
              <div class="detail-column">
                <label> <b>Alternativa No.:</b> {{i+1}}. &emsp;&emsp;</label>
                <label><b>Tipo de Idea:</b> {{alternative?.typeProject}}&emsp;&emsp;</label>
                <label><b>Proceso:</b> {{alternative?.proccess}}&emsp;&emsp;</label>
                <label><b>Objeto:</b> {{alternative?.object}}&emsp;&emsp;</label>
              </div>
              <div class="detail-column">
                <label><b>Departamento:</b> {{alternative?.departament}}&emsp;&emsp;</label>
                <label><b>Municipio:</b> {{alternative?.municipality}}&emsp;&emsp;</label>
                <label><b>Entidad Responsable:</b> {{alternative?.nameEPI}}&emsp;&emsp;</label>
                <label><b>Poblacion de Referencia:</b> {{alternative?.referencePop}}&emsp;&emsp;</label>
              </div>
              <div class="detail-column">
                <label><b>Genero:</b> {{alternative?.type}}: {{alternative?.total}} y {{alternative?.type2}}:
                  {{alternative?.total2}}&emsp;&emsp;</label>
                <label><b>Denominacion:</b> {{alternative?.denomination}}&emsp;&emsp;</label>
                <label><b>Tipo de Proyecto:</b> {{alternative?.typeProjectFormulation}}&emsp;&emsp;</label>
                <label><b>Complejidad:</b> {{alternative?.complexity}}&emsp;&emsp;</label>
                <label><b>Costo de la Preinversión:</b> {{alternative?.investmentCost.toLocaleString("es-GT", {style: "currency", currency: "GTQ"})}&emsp;&emsp;</label>
              </div>
              <div class="detail-column">
                <label><b>Costo de la Inversión:</b> {{alternative?.estimatedCost.toLocaleString("es-GT", {style: "currency", currency: "GTQ"})}&emsp;&emsp;</label>
                <label><b>Fuente de Financiamiento:</b> {{alternative?.foundingSourcesName}}&emsp;&emsp;</label>
                <label><b>Fecha Inicio Ejecución:</b>
                  {{alternative?.executionDateMonth}}/20{{alternative?.executionDateYear}}&emsp;&emsp;</label>
                <label><b>Fecha Fin Ejecución:</b>
                  {{alternative?.finishDateMonth}}/20{{alternative?.finishDateYear}}&emsp;&emsp;</label>
                <label><b>Etapa Sugerida preinversión:</b> {{alternative?.etapaValor}}&emsp;&emsp;</label>
                <label><b>Total Obtenido:</b> {{alternative?.etapaResultado}}&emsp;&emsp;</label>
              </div>
              <mat-divider>
              </mat-divider>
            </div>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand"></tr>
      <tr mat-row *matRowDef="let element; columns: columnsToDisplayWithExpand;" class="example-element-row"
        [class.example-expanded-row]="expandedElement === element">
      </tr>
      <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
    </table>

    <mat-paginator *ngIf="dataSource.data.length > 0" [length]="100" [pageSize]="10"
      [pageSizeOptions]="[5, 10, 25, 100]">
    </mat-paginator>

  </ngx-simplebar>

</div>